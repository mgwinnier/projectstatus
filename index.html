<!DOCTYPE html>
<html>
<head>
  <title>Google Sheets API Web App</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://apis.google.com/js/api.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      padding: 5px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
  </style>
</head>
<body>
  <h1>Google Sheets API Web App</h1>
  <button id="authorize_button" onclick="handleAuthClick()">Authorize</button>
  <button id="signout_button" onclick="handleSignoutClick()" style="display: none;">Sign Out</button>

  <table id="project-data" border="1">
    <thead>
      <tr>
        <th>Project Name</th>
        <th>Project Manager</th>
        <th>Project Milestone</th>
        <th>Schedule</th>
        <th>Next Submittal Date</th>
        <th>Budget</th>
        <th>Budget Spent</th>
        <th>Amount Invoiced</th>
        <th>Outstanding Invoice</th>
        <th>Notes</th>
      </tr>
    </thead>
    <tbody>
      <!-- Data will be populated here -->
    </tbody>
  </table>

  <script>
    // Replace with your CLIENT_ID and API_KEY
    const CLIENT_ID = '762480932613-ersmt8emcojvsggenh1lmo40bvu01h1j.apps.googleusercontent.com';
    const API_KEY = 'AIzaSyAsav7hEKLla2FBNTq7WrZI0vH_JXwT7p4';
    
    const DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];
    const SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";
    
    function handleClientLoad() {
      gapi.load('client:auth2', initClient);
    }
    
    function initClient() {
      gapi.client.init({
        apiKey: API_KEY,
        clientId: CLIENT_ID,
        discoveryDocs: DISCOVERY_DOCS,
        scope: SCOPES
      }).then(function () {
        gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
        updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
      }, function (error) {
        console.error(JSON.stringify(error, null, 2));
      });
    }
    
    function updateSigninStatus(isSignedIn) {
      if (isSignedIn) {
        document.getElementById('authorize_button').style.display = 'none';
        document.getElementById('signout_button').style.display = 'inline-block';
        displaySheetData();
      } else {
        document.getElementById('authorize_button').style.display = 'inline-block';
        document.getElementById('signout_button').style.display = 'none';
      }
    }
    
    function handleAuthClick() {
      gapi.auth2.getAuthInstance().signIn();
    }
    
    function handleSignoutClick() {
      gapi.auth2.getAuthInstance().signOut();
    }
    
    function displaySheetData() {
      const sheetId = '1iUC78Rg3sVqA8rd-ICu2ShFs3lNbR072RJTofo53Ojc';
      const range = 'Sheet1!A1:J'; // Adjust the range to match your sheet
      
      gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: sheetId,
        range: range,
      }).then((response) => {
        let data = response.result.values;
        let tableBody = document.getElementById("project-data").getElementsByTagName("tbody")[0];
        
        if (data.length > 0) {
          data.shift(); // Remove the header row from the data
          for (let i = 0; i < data.length; i++) {
            let row = tableBody.insertRow(-1);
            for (let j = 0; j < data[i].length; j++) {
              let cell = row.insertCell(-1);
              cell.innerHTML = data[i][j];
            }
          }
        } else {
          console.log("No data found.");
        }
      }, (response) => {
        console.error("Error: " + response.result.error.message);
      });
    }
  </script>
  <script async defer onload="handleClientLoad()" src="https://apis.google.com/js/api.js"></script>
</body>
</html>
