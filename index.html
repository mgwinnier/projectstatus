<!DOCTYPE html>
<html>
<head>
  <title>Example Client Project Status Update</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://apis.google.com/js/api.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      padding: 5px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
  </style>
</head>
<body>
  <h1>Google Sheets API Web App</h1>

  <table id="project-data" border="1">
    <thead>
      <tr>
        <th>Project Name</th>
        <th>Project Manager</th>
        <th>Project Milestone</th>
        <th>Schedule</th>
        <th>Next Submittal Date</th>
        <th>Budget</th>
        <th>Budget Spent</th>
        <th>Amount Invoiced</th>
        <th>Outstanding Invoice</th>
        <th>Notes</th>
      </tr>
    </thead>
    <tbody>
      <!-- Data will be populated here -->
    </tbody>
  </table>

  <script>
    // Replace with your API_KEY
    const API_KEY = 'AIzaSyAGmDYWROjUWGW_xD9nGWPPiYSq7OaG8qA';

    const DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];
    const SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";

    function handleClientLoad() {
      gapi.load('client', initClient);
    }

    function initClient() {
      gapi.client.init({
        apiKey: API_KEY,
        discoveryDocs: DISCOVERY_DOCS,
        scope: SCOPES
      }).then(function () {
        displaySheetData();
      }, function (error) {
        console.error(JSON.stringify(error, null, 2));
      });
    }

    function displaySheetData() {
      const sheetId = '1iUC78Rg3sVqA8rd-ICu2ShFs3lNbR072RJTofo53Ojc';
      const range = 'Sheet1!A1:J'; // Adjust the range to match your sheet

      gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: sheetId,
        range: range,
      }).then((response) => {
        let data = response.result.values;
        let tableBody = document.getElementById("project-data").getElementsByTagName("tbody")[0];

        if (data.length > 0) {
          data.shift(); // Remove the header row from the data
          for (let i = 0; i < data.length; i++) {
            let row = tableBody.insertRow(-1);
            for (let j = 0; j < data[i].length; j++) {
              let cell = row.insertCell(-1);
              cell.innerHTML = data[i][j];
            }
          }
        } else {
          console.log("No data found.");
        }
      }, (response) => {
        console.error("Error: " + response.result.error.message);
      });
    }
  </script>
  <script async defer onload="handleClientLoad()" src="https://apis.google.com/js/api.js"></script>
</body>
</html>
